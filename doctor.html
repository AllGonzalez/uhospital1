<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>home Doctor</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"/>
      <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

      <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
    <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
    
</head>
<body>
    <nav class="navbar navbar-dark bg-dark mb-5">
        <a class="navbar-brand" href="#">
          <img
            src="./assets/doctor.png"
            width="30"
            height="30"
            class="d-inline-block align-top"
            alt=""
          />
          Doctor
        </a>
        <div class="row">
          <div class="col">
            <p id="currentUser" class="text-uppercase text-white" style="width: 20rem;"></p>
          </div>
          <div class="col">
            <button type="button" class="btn btn-danger pull-left" onclick="Logout()">Cerrar Sesión</button>
          </div>
        </div>
      </nav>

      <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Citas Pendientes de Aceptar</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Citas Asignadas</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false">Generar Receta</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="pills-contact2-tab" data-toggle="pill" href="#pills-contact2" role="tab" aria-controls="pills-contact2" aria-selected="false">Modificar Perfil</a>
        </li>
      </ul>
      <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
          <table class="table" id="tabla">
            <thead class="thead-dark">
              <tr>
                <th scope="col">No.</th>
                <th scope="col">Fecha</th>
                <th scope="col">Hora</th>
                <th scope="col">Motivo</th>
                <th scope="col">Opciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">1</th>
                <td>25/02/2021</td>
                <td>12:50 PM</td>
                <td>Dolor de Cabeza</td>
                <td>
                  <button type="button" class="btn btn-success">Aceptar</button>
                    <button type="button" class="btn btn-danger">Rechazar</button>
                </td>
              </tr>
              <tr>
                <th scope="row">2</th>
                <td>15/04/2021</td>
                <td>09:20 AM</td>
                <td>Consulta Popular</td>
                <td>
                  <button type="button" class="btn btn-success">Aceptar</button>
                    <button type="button" class="btn btn-danger">Rechazar</button>
                </td>
              </tr>
              <tr>
                <th scope="row">3</th>
                <td>25/04/2021</td>
                <td>10:20 AM</td>
                <td>Dolor de Espalda</td>
                <td>
                  <button type="button" class="btn btn-success">Aceptar</button>
                    <button type="button" class="btn btn-danger">Rechazar</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
          <table class="table" id="tabla2">
            <thead class="thead-dark">
              <tr>
                <th scope="col">No.</th>
                <th scope="col">Fecha</th>
                <th scope="col">Hora</th>
                <th scope="col">Motivo</th>
                <th scope="col">Opciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">1</th>
                <td>25/02/2021</td>
                <td>12:50 PM</td>
                <td>Dolor de Cabeza</td>
                <td>
                  <input type="checkbox" >
                </td>
              </tr>
              <tr>
                <th scope="row">2</th>
                <td>15/04/2021</td>
                <td>09:20 AM</td>
                <td>Consulta Popular</td>
                <td>
                  <input type="checkbox" >
                </td>
              </tr>
              <tr>
                <th scope="row">3</th>
                <td>25/04/2021</td>
                <td>10:20 AM</td>
                <td>Dolor de Espalda</td>
                <td>
                  <input type="checkbox" >
                </td>
              </tr>
            </tbody>
          </table>
          <div class="d-flex justify-content-center">
            <button type="button" class="btn btn-success btn-lg">Completada(s)</button>
          </div>
          
        </div>
        <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">
          
        <div class="container">
          <div class="row">
            <div class="col">


              <form id="receta">
                <div class="form-group">
                  <label for="exampleInputPassword1">Fecha dd/mm/yyyy</label>
                 <input type="text" class="form-control" id="date" class="fas fa-dolly-flatbed-alt"></i>
                  </div>


                <div class="form-group">
                  <label for="exampleInputPassword1">Nombre Paciente</label>
                 <input type="text" class="form-control" id="name" placeholder="Nombre del paciente">
                  </div>

                  <div class="form-group">
                    <label for="exampleInputPassword1">Padecimiento</label>
                   <input type="text" class="form-control" id="padecimiento" placeholder="">
                    </div>

                
                <div class="form-group">
                  <label for="exampleFormControlTextarea1">Descripción</label>
                  <textarea class="form-control" id="description" rows="3"></textarea>
                </div>
              </form>
              <div class="d-flex justify-content-center">
                <button type="button" class="btn btn-success btn-lg" id="genReceta">Generar Receta</button>
              </div>

            </div>
          </div>
        </div>
          


      </div>

      <div class="tab-pane fade" id="pills-contact2" role="tabpanel" aria-labelledby="pills-contact2-tab">

        <div class="container">
          <div class="row">
            <div clas= "col">

              <form id="editForm">
                <div class="form-group">
                  <label for="exampleInputEmail1">Nombre</label>
                  <input type="text" class="form-control" id="newName" aria-describedby="emailHelp" placeholder="Ingrese el Nombre">
                  
                </div>
                <div class="form-group">
                  <label for="exampleInputPassword1">Apellido</label>
                  <input type="text" class="form-control" id="newLastName" placeholder="Ingrese el apellido">
                </div>
                <div class="form-group">
                  <label for="exampleInputPassword1">Contraseña</label>
                  <input type="password" class="form-control" id="newPassword" placeholder="Ingrese la nueva contraseña">
                </div>
                <div class="form-group">
                  <label for="exampleInputPassword1">Fecha de nacimiento dd/mm/yyyy</label>
                  <input type="text" class="form-control" id="newDate" placeholder="">
                </div>
                <div class="form-group">
                  <label for="exampleInputPassword1">Teléfono</label>
                  <input type="text" class="form-control" id="newPhone" placeholder="">
                </div>
                <select class="custom-select" id="newGender">
                  <option selected>Seleccionar sexo</option>
                  <option value="M">M</option>
                  <option value="F">F</option>
                </select>
                </div>
                
                
                <button type="submit" class="btn btn-primary btn-block mt-3"id="editButton">Modificar</button>
              </form>


            </div>
            
          </div>
        </div>

      </div>


      </div>
      
            <script>
              function Logout(){
               window.location="index.html"
              }
              </script>

              <script>
        //Geting URL params

        const queryStrings = window.location.search;
                        const urlParams = new URLSearchParams(queryStrings);
                        const firstName = urlParams.get("first_name");
                        const lastName = urlParams.get("last_name");
                        const nicknameOld = urlParams.get("nickname");
                        const specialityOld = urlParams.get("speciality");
                        const typeOld = urlParams.get("type");

          //getting inputs
                        let currentUser = document.getElementById("currentUser");
                        currentUser.innerText = `Bienvenido(a) Dr.: ${firstName} ${lastName}!`;
          //Metodo PUT
        let editForm = document.getElementById("editForm");
    let newName = document.getElementById("newName");
    let newLastName=document.getElementById("newLastName");
	  let newPassword = document.getElementById("newPassword");
    let newDate= document.getElementById("newDate");
    let newSpeciality= document.getElementById("newSpeciality")
    let newPhone =document.getElementById("newPhone");
    let newGender=document.getElementById("newGender");
	  let editButton = document.getElementById("editButton");
    
  editForm.addEventListener("submit", (e) => {
	  e.preventDefault();
	});

    
    editButton.addEventListener("click",(e)=>{
        const modifyDoctor={
            first_name: newName.value,
            last_name: newLastName.value,
            date: newDate.value,
            gender: newGender.value,
            nickname: nicknameOld,
            password: newPassword.value,
            speciality: specialityOld,
            phone: newPhone.value,
            type: typeOld
    };
        console.log(modifyDoctor);

        fetch("https://uhospitalipc1.herokuapp.com/doctor", {
            method: "PUT",
            headers: {
            "content-type": "application/json",
            },
            body: JSON.stringify(modifyDoctor),        })
            .then((response) => response.json())
            .then((data) => {
            if (data.message) {
            alert("Modificado Exitosamente, inicie sesion de nuevo por favor");
            
            window.location = "login.html";
            } else {
            console.error(data);
            alert("Nickname Repetido");                                    }
        })

        .catch((error)=> console.error(error));

    });
            
              </script>






              <script>
    let recetaForm = document.getElementById("receta");
    let name = document.getElementById("name");
    let date=document.getElementById("date");
	  let padecimiento = document.getElementById("padecimiento");
    let description = document.getElementById("description");
	  let genReceta = document.getElementById("genReceta"); 

    //Post
    recetaForm.addEventListener("submit", (e) => {
                                e.preventDefault();
    });

    genReceta.addEventListener("click", (e) => {
                                const newPrescription = {
                                        name: name.value,
                                        date: date.value,
                                        padecimiento: padecimiento.value,
                                        description: description.value
                                };
                                console.log(newPrescription);
                                fetch("https://uhospitalipc1.herokuapp.com/prescription", {
                                        method: "POST",
                                        headers: {
                                                "content-type": "application/json",
                                        },
                                        body: JSON.stringify(newPrescription),
                                })
                                        .then((response) => response.json())
                                        .then((data) => {
                                                if (data.message) {
                                                        console.error(data);
														                    alert("Error en la factura");
														
                                                } else {
                                                  window.open("https://uhospitalipc1.herokuapp.com/reports/prescriptions");
                                                }
                                        })
                                        .catch((error) => console.error(error));
                        });

              </script>
      <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
</body>
</html>